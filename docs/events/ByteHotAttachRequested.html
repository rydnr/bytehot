<!DOCTYPE html>
<html>
<head>
    <title>ByteHotAttachRequested - ByteHot Documentation</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
<h1 id="overview">Overview</h1>
<p>The <code>ByteHotAttachRequested</code> event represents the primary
trigger that initiates the ByteHot system lifecycle. This domain event
encapsulates all necessary information for attaching and configuring the
ByteHot agent within a JVM runtime environment, serving as the
foundational event that transforms a standard Java application into a
hot-swap enabled system.</p>
<h1 id="domain-event-classification">Domain Event Classification</h1>
<h2 id="event-type-command-event">Event Type: Command Event</h2>
<p><code>ByteHotAttachRequested</code> represents a command event that
carries an imperative: "attach the ByteHot agent with this
configuration." It differs from notification events by explicitly
requesting action rather than reporting something that has already
occurred.</p>
<h2 id="event-flow-position">Event Flow Position</h2>
<p>In the ByteHot event flow, this event serves as:</p>
<ul>
<li><strong>Initialization Trigger</strong>: The first event in any
ByteHot session</li>
<li><strong>Configuration Carrier</strong>: Contains all necessary setup
parameters</li>
<li><strong>Lifecycle Initiator</strong>: Triggers the complete system
startup sequence</li>
</ul>
<h1 id="event-structure-and-data">Event Structure and Data</h1>
<h2 id="core-event-data">Core Event Data</h2>
<p>The event encapsulates essential information for ByteHot
initialization:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> ByteHotAttachRequested <span class="kw">implements</span> DomainEvent <span class="op">{</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="dt">final</span> <span class="bu">Instrumentation</span> instrumentation<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="dt">final</span> WatchConfiguration configuration<span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="dt">final</span> <span class="bu">String</span> sessionId<span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="dt">final</span> Instant requestedAt<span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="dt">final</span> UserId requestedBy<span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="instrumentation-context">Instrumentation Context</h2>
<ul>
<li><strong>JVM Instrumentation</strong>: Direct access to Java
instrumentation capabilities</li>
<li><strong>Capability Verification</strong>: Enables validation of
hot-swap support</li>
<li><strong>Runtime Integration</strong>: Bridges domain logic with JVM
internals</li>
</ul>
<h2 id="configuration-specification">Configuration Specification</h2>
<ul>
<li><strong>Watch Paths</strong>: Directories to monitor for class file
changes</li>
<li><strong>File Patterns</strong>: Specific patterns to match (e.g.,
"*.class")</li>
<li><strong>Monitoring Options</strong>: Recursive watching, exclusion
patterns</li>
<li><strong>Performance Tuning</strong>: Polling intervals, batch
processing settings</li>
</ul>
<h1 id="event-semantics-and-intent">Event Semantics and Intent</h1>
<h2 id="semantic-meaning">Semantic Meaning</h2>
<p>"A request has been made to attach the ByteHot agent to this JVM with
the specified configuration, enabling hot-swap capabilities for the
defined watch paths."</p>
<h2 id="business-intent">Business Intent</h2>
<ul>
<li>Enable runtime bytecode modification capabilities</li>
<li>Establish file system monitoring for automatic change detection</li>
<li>Initialize user session tracking for audit and analytics</li>
<li>Configure system parameters for optimal performance</li>
</ul>
<h2 id="temporal-characteristics">Temporal Characteristics</h2>
<ul>
<li><strong>Immediate Processing</strong>: Requires immediate response
for system readiness</li>
<li><strong>One-Time Event</strong>: Typically occurs once per JVM
session</li>
<li><strong>Session Boundary</strong>: Marks the beginning of a
ByteHot-enabled session</li>
</ul>
<h1 id="event-processing-flow">Event Processing Flow</h1>
<h2 id="primary-event-handler">Primary Event Handler</h2>
<p>The <code>ByteHot</code> aggregate serves as the primary handler for
this event:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">static</span> DomainResponseEvent<span class="op">&lt;</span>ByteHotAttachRequested<span class="op">&gt;</span> <span class="fu">accept</span><span class="op">(</span><span class="dt">final</span> ByteHotAttachRequested event<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    DomainResponseEvent<span class="op">&lt;</span>ByteHotAttachRequested<span class="op">&gt;</span> result <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span> <span class="fu">ByteHot</span><span class="op">(</span>event<span class="op">.</span><span class="fu">getInstrumentation</span><span class="op">(),</span> event<span class="op">.</span><span class="fu">getConfiguration</span><span class="op">())</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">start</span><span class="op">(</span>event<span class="op">);</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="kw">new</span> <span class="fu">ByteHotAgentAttached</span><span class="op">(</span>event<span class="op">,</span> event<span class="op">.</span><span class="fu">getConfiguration</span><span class="op">());</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="dt">final</span> <span class="bu">Throwable</span> t<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="kw">new</span> <span class="fu">ByteHotNotStarted</span><span class="op">(</span>event<span class="op">,</span> t<span class="op">);</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="processing-stages">Processing Stages</h2>
<ol>
<li><strong>Validation</strong>: Verify instrumentation availability and
configuration validity</li>
<li><strong>Aggregate Creation</strong>: Instantiate ByteHot aggregate
with event parameters</li>
<li><strong>System Startup</strong>: Initialize monitoring,
capabilities, and infrastructure</li>
<li><strong>Result Generation</strong>: Produce success or failure
response event</li>
</ol>
<h1 id="response-events">Response Events</h1>
<h2 id="success-response-bytehotagentattached">Success Response:
ByteHotAgentAttached</h2>
<p>When processing succeeds, the system emits
<code>ByteHotAgentAttached</code>:</p>
<ul>
<li>Confirms successful agent attachment</li>
<li>Includes effective configuration used</li>
<li>Provides reference to original request event</li>
<li>Enables subsequent system operations</li>
</ul>
<h2 id="failure-response-bytehotnotstarted">Failure Response:
ByteHotNotStarted</h2>
<p>When processing fails, the system emits
<code>ByteHotNotStarted</code>:</p>
<ul>
<li>Documents the failure with complete error context</li>
<li>Preserves original request for debugging</li>
<li>Enables error recovery or alternative approaches</li>
<li>Maintains event-driven error handling consistency</li>
</ul>
<h1 id="configuration-integration">Configuration Integration</h1>
<h2 id="watchconfiguration-contents">WatchConfiguration Contents</h2>
<p>The embedded configuration specifies:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> WatchConfiguration <span class="op">{</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="dt">final</span> <span class="bu">List</span><span class="op">&lt;</span>Path<span class="op">&gt;</span> watchPaths<span class="op">;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="dt">final</span> <span class="bu">List</span><span class="op">&lt;</span><span class="bu">String</span><span class="op">&gt;</span> includePatterns<span class="op">;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="dt">final</span> <span class="bu">List</span><span class="op">&lt;</span><span class="bu">String</span><span class="op">&gt;</span> excludePatterns<span class="op">;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="dt">final</span> <span class="bu">Duration</span> pollInterval<span class="op">;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="dt">final</span> <span class="dt">boolean</span> recursiveWatching<span class="op">;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="dt">final</span> <span class="dt">int</span> maxConcurrentWatchers<span class="op">;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="configuration-validation">Configuration Validation</h2>
<p>During event processing:</p>
<ul>
<li>Path existence verification</li>
<li>Pattern syntax validation</li>
<li>Resource availability checks</li>
<li>Performance parameter optimization</li>
</ul>
<h1 id="user-context-and-analytics">User Context and Analytics</h1>
<h2 id="user-identification">User Identification</h2>
<p>The event includes user context for:</p>
<ul>
<li>Audit trail establishment</li>
<li>User-specific analytics</li>
<li>Personalized configuration preferences</li>
<li>Collaborative development support</li>
</ul>
<h2 id="session-management">Session Management</h2>
<ul>
<li>Unique session identification</li>
<li>Development environment tracking</li>
<li>Performance baseline establishment</li>
<li>User behavior pattern initiation</li>
</ul>
<h1 id="infrastructure-coordination">Infrastructure Coordination</h1>
<h2 id="jvm-integration-points">JVM Integration Points</h2>
<p>The event facilitates integration with:</p>
<ul>
<li><strong>Java Instrumentation API</strong>: Direct bytecode
manipulation capabilities</li>
<li><strong>File System Watchers</strong>: Native OS file monitoring
services</li>
<li><strong>Class Loading Infrastructure</strong>: JVM class loader
coordination</li>
<li><strong>Thread Management</strong>: Concurrent operation
support</li>
</ul>
<h2 id="platform-abstraction">Platform Abstraction</h2>
<p>While carrying platform-specific data (Instrumentation), the event
maintains platform abstraction through:</p>
<ul>
<li>Interface-based instrumentation access</li>
<li>Configuration-driven behavior specification</li>
<li>Event-driven response handling</li>
<li>Clean error boundary establishment</li>
</ul>
<h1 id="testing-and-verification">Testing and Verification</h1>
<h2 id="event-creation-for-testing">Event Creation for Testing</h2>
<div class="sourceCode" id="cb4"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="at">@Test</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="fu">shouldCreateValidAttachRequest</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Given: Valid instrumentation and configuration</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">Instrumentation</span> instrumentation <span class="op">=</span> <span class="fu">mock</span><span class="op">(</span><span class="bu">Instrumentation</span><span class="op">.</span><span class="fu">class</span><span class="op">);</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    WatchConfiguration config <span class="op">=</span> WatchConfiguration<span class="op">.</span><span class="fu">builder</span><span class="op">()</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">watchPaths</span><span class="op">(</span><span class="bu">List</span><span class="op">.</span><span class="fu">of</span><span class="op">(</span>Paths<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="st">&quot;target/classes&quot;</span><span class="op">)))</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">includePatterns</span><span class="op">(</span><span class="bu">List</span><span class="op">.</span><span class="fu">of</span><span class="op">(</span><span class="st">&quot;**/*.class&quot;</span><span class="op">))</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">build</span><span class="op">();</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// When: Event is created</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    ByteHotAttachRequested event <span class="op">=</span> <span class="kw">new</span> <span class="fu">ByteHotAttachRequested</span><span class="op">(</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>        instrumentation<span class="op">,</span> config<span class="op">,</span> <span class="st">&quot;test-session&quot;</span><span class="op">,</span> Instant<span class="op">.</span><span class="fu">now</span><span class="op">(),</span> UserId<span class="op">.</span><span class="fu">of</span><span class="op">(</span><span class="st">&quot;test-user&quot;</span><span class="op">)</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">);</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Then: Event should be valid and processable</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assertThat</span><span class="op">(</span>event<span class="op">.</span><span class="fu">getInstrumentation</span><span class="op">()).</span><span class="fu">isEqualTo</span><span class="op">(</span>instrumentation<span class="op">);</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assertThat</span><span class="op">(</span>event<span class="op">.</span><span class="fu">getConfiguration</span><span class="op">()).</span><span class="fu">isEqualTo</span><span class="op">(</span>config<span class="op">);</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="processing-verification">Processing Verification</h2>
<div class="sourceCode" id="cb5"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="at">@Test</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="fu">shouldProcessAttachRequestSuccessfully</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Given: Valid attach request</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    ByteHotAttachRequested request <span class="op">=</span> <span class="fu">createValidAttachRequest</span><span class="op">();</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// When: Event is processed</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    DomainResponseEvent<span class="op">&lt;</span>ByteHotAttachRequested<span class="op">&gt;</span> response <span class="op">=</span> ByteHot<span class="op">.</span><span class="fu">accept</span><span class="op">(</span>request<span class="op">);</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Then: Should return success event</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assertThat</span><span class="op">(</span>response<span class="op">).</span><span class="fu">isInstanceOf</span><span class="op">(</span>ByteHotAgentAttached<span class="op">.</span><span class="fu">class</span><span class="op">);</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assertThat</span><span class="op">(</span>response<span class="op">.</span><span class="fu">getPreceding</span><span class="op">()).</span><span class="fu">isEqualTo</span><span class="op">(</span>request<span class="op">);</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="error-scenarios-and-recovery">Error Scenarios and Recovery</h1>
<h2 id="common-failure-conditions">Common Failure Conditions</h2>
<ul>
<li><strong>Instrumentation Unavailable</strong>: JVM doesn't support
required instrumentation</li>
<li><strong>Invalid Configuration</strong>: Watch paths don't exist or
are inaccessible</li>
<li><strong>Resource Constraints</strong>: Insufficient permissions or
system resources</li>
<li><strong>Initialization Conflicts</strong>: Another agent or system
conflict</li>
</ul>
<h2 id="error-context-preservation">Error Context Preservation</h2>
<p>Failed processing preserves complete context:</p>
<ul>
<li>Original event data for replay</li>
<li>Detailed error information for diagnosis</li>
<li>System state at failure time</li>
<li>Recovery guidance when possible</li>
</ul>
<h1 id="event-sourcing-implications">Event Sourcing Implications</h1>
<h2 id="event-storage-considerations">Event Storage Considerations</h2>
<ul>
<li>Complete instrumentation context cannot be serialized</li>
<li>Configuration data should be fully persistent</li>
<li>User context enables event replay for different users</li>
<li>Temporal data supports audit and compliance requirements</li>
</ul>
<h2 id="replay-scenarios">Replay Scenarios</h2>
<ul>
<li>Development environment recreation</li>
<li>Issue reproduction from production</li>
<li>Configuration testing and validation</li>
<li>User behavior analysis</li>
</ul>
<h1 id="security-and-compliance">Security and Compliance</h1>
<h2 id="security-implications">Security Implications</h2>
<ul>
<li>Instrumentation access represents significant JVM privileges</li>
<li>Configuration may expose file system structure</li>
<li>User identification enables access control</li>
<li>Session tracking supports security auditing</li>
</ul>
<h2 id="compliance-support">Compliance Support</h2>
<ul>
<li>Complete audit trail from first system interaction</li>
<li>User attribution for all subsequent operations</li>
<li>Configuration change tracking</li>
<li>Temporal accountability for all actions</li>
</ul>
<h1 id="performance-considerations">Performance Considerations</h1>
<h2 id="processing-efficiency">Processing Efficiency</h2>
<ul>
<li>Event processing should complete within milliseconds</li>
<li>Configuration validation should be non-blocking where possible</li>
<li>Resource allocation should be lazy and on-demand</li>
<li>Error handling should not impact performance</li>
</ul>
<h2 id="resource-management">Resource Management</h2>
<ul>
<li>Instrumentation references should not prevent garbage
collection</li>
<li>Configuration data should be efficiently stored</li>
<li>Event metadata should use minimal memory</li>
<li>Processing should scale with configuration complexity</li>
</ul>
<h1 id="related-documentation">Related Documentation</h1>
<ul>
<li><a href="../ByteHot.org">ByteHot</a>: Primary event handler
aggregate</li>
<li><a href="../WatchConfiguration.org">WatchConfiguration</a>:
Configuration value object</li>
<li><a href="./ByteHotAgentAttached.org">ByteHotAgentAttached</a>:
Success response event</li>
<li><a href="./ByteHotNotStarted.org">ByteHotNotStarted</a>: Failure
response event</li>
<li><a href="../../flows/bytehot-startup-flow.org">ByteHot Startup
Flow</a>: Complete initialization sequence</li>
</ul>
<h1 id="future-evolution">Future Evolution</h1>
<h2 id="anticipated-enhancements">Anticipated Enhancements</h2>
<ul>
<li>Configuration versioning and migration support</li>
<li>Distributed agent coordination for microservices</li>
<li>Enhanced security and permission management</li>
<li>Advanced configuration validation and optimization</li>
</ul>
<h2 id="backward-compatibility">Backward Compatibility</h2>
<p>Event structure designed for evolution:</p>
<ul>
<li>Optional fields for new capabilities</li>
<li>Version information for migration support</li>
<li>Extensible configuration structure</li>
<li>Preserved core semantics across versions</li>
</ul>
<p>The <code>ByteHotAttachRequested</code> event represents the
foundational contract that initiates ByteHot's revolutionary
hot-swapping capabilities, establishing the system's runtime context and
configuration while maintaining clean event-driven semantics.</p>
</body></html>
