<!DOCTYPE html>
<html>
<head>
    <title>ByteHotApplication - ByteHot Documentation</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
<div class="navigation">
    <a href="../index.html">üè† Home</a>
    <a href="../implementation.html">üèóÔ∏è Implementation</a>
    <a href="../journal.html">üìî Journal</a>
    <a href="../docs/">üìö Docs</a>
    <a href="../javadocs/">üìñ Javadocs</a>
    <a href="https://github.com/rydnr/bytehot">üîó GitHub</a>
</div>
<main>
<h1 id="overview">Overview</h1>
<p>The <code>ByteHotApplication</code> class serves as the central
orchestrator in the Application Layer of ByteHot's hexagonal
architecture. It bridges the gap between the pure domain logic and the
infrastructure adapters, managing the critical responsibilities of
adapter discovery, dependency injection, and event routing.</p>
<h1 id="architectural-role">Architectural Role</h1>
<h2 id="application-layer-position">Application Layer Position</h2>
<p>Within the Domain-Driven Design and Hexagonal Architecture framework,
<code>ByteHotApplication</code> occupies the application layer, which
has these essential responsibilities:</p>
<ul>
<li><strong>Port-Adapter Wiring</strong>: Discovers and injects
infrastructure adapters into domain ports</li>
<li><strong>Event Routing</strong>: Routes incoming events to
appropriate domain aggregates</li>
<li><strong>Lifecycle Management</strong>: Manages the initialization
and configuration of the entire system</li>
<li><strong>Adapter Discovery</strong>: Automatically discovers
available infrastructure implementations</li>
</ul>
<h2 id="hexagonal-architecture-integration">Hexagonal Architecture
Integration</h2>
<p>The application layer acts as the composition root, implementing the
dependency inversion principle by:</p>
<pre><code>Infrastructure Layer ‚Üê Application Layer ‚Üí Domain Layer
    (Adapters)            (Wiring)         (Ports)
</code></pre>
<h1 id="class-structure-and-design-patterns">Class Structure and Design
Patterns</h1>
<h2 id="singleton-pattern-implementation">Singleton Pattern
Implementation</h2>
<p>ByteHotApplication implements the Singleton pattern using the
Initialization-on-demand holder idiom:</p>
<div class="sourceCode" id="cb2"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/application/ByteHotApplication.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Returns the singleton instance of ByteHotApplication<span class="co">.</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@return</span> the singleton instance<span class="co">.</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">static</span> ByteHotApplication <span class="fu">getInstance</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Holder</span><span class="op">.</span><span class="fu">INSTANCE</span><span class="op">;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Holder class for the singleton instance of ByteHotApplication<span class="co">.</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="kw">protected</span> <span class="dt">static</span> <span class="kw">class</span> <span class="bu">Holder</span> <span class="op">{</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="dt">static</span> <span class="dt">final</span> ByteHotApplication INSTANCE <span class="op">=</span> <span class="kw">new</span> <span class="fu">ByteHotApplication</span><span class="op">();</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Design Rationale</strong>: The holder idiom provides
thread-safe lazy initialization without synchronization overhead,
ensuring exactly one application instance manages the system's
lifecycle.</p>
<h2 id="initialization-state-management">Initialization State
Management</h2>
<p>Thread-safe initialization prevents race conditions during adapter
discovery:</p>
<div class="sourceCode" id="cb3"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/application/ByteHotApplication.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Whether adapters have been initialized</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="dt">static</span> <span class="kw">volatile</span> <span class="dt">boolean</span> adaptersInitialized <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Initializes the application with the given instrumentation</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">initialize</span><span class="op">(</span><span class="dt">final</span> <span class="bu">Instrumentation</span> instrumentation<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>adaptersInitialized<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">synchronized</span> <span class="op">(</span>ByteHotApplication<span class="op">.</span><span class="fu">class</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span>adaptersInitialized<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                <span class="fu">discoverAndInjectAdapters</span><span class="op">(</span>instrumentation<span class="op">);</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                adaptersInitialized <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Double-Checked Locking</strong>: Ensures thread safety while
minimizing synchronization overhead for subsequent calls.</p>
<h1 id="event-processing-architecture">Event Processing
Architecture</h1>
<h2 id="primary-event-handler-implementation">Primary Event Handler
Implementation</h2>
<p>Implements the <code>HandlesByteHotAttached</code> interface to
process attachment requests:</p>
<div class="sourceCode" id="cb4"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/application/ByteHotApplication.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Accepts a ByteHotAttachRequested event<span class="co">.</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">event</span><span class="co"> </span>such event<span class="co">.</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@return</span> A list of events in response<span class="co">.</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="at">@Override</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="bu">List</span><span class="op">&lt;</span>DomainResponseEvent<span class="op">&lt;</span>ByteHotAttachRequested<span class="op">&gt;&gt;</span> <span class="fu">accept</span><span class="op">(</span><span class="dt">final</span> ByteHotAttachRequested event<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Ensure adapters are initialized</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>adaptersInitialized<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">IllegalStateException</span><span class="op">(</span><span class="st">&quot;Application not initialized. Call initialize() with Instrumentation first.&quot;</span><span class="op">);</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">List</span><span class="op">&lt;</span>DomainResponseEvent<span class="op">&lt;</span>ByteHotAttachRequested<span class="op">&gt;&gt;</span> responseEvents <span class="op">=</span> <span class="bu">Arrays</span><span class="op">.</span><span class="fu">asList</span><span class="op">(</span>ByteHot<span class="op">.</span><span class="fu">accept</span><span class="op">(</span>event<span class="op">));</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Emit the response events</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> EventEmitterPort eventEmitter <span class="op">=</span> Ports<span class="op">.</span><span class="fu">resolve</span><span class="op">(</span>EventEmitterPort<span class="op">.</span><span class="fu">class</span><span class="op">);</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> <span class="bu">List</span><span class="op">&lt;</span>DomainResponseEvent<span class="op">&lt;?&gt;&gt;</span> genericEvents <span class="op">=</span> <span class="kw">new</span> <span class="bu">ArrayList</span><span class="op">&lt;&gt;();</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">final</span> DomainResponseEvent<span class="op">&lt;</span>ByteHotAttachRequested<span class="op">&gt;</span> responseEvent <span class="op">:</span> responseEvents<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>            genericEvents<span class="op">.</span><span class="fu">add</span><span class="op">(</span>responseEvent<span class="op">);</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        eventEmitter<span class="op">.</span><span class="fu">emit</span><span class="op">(</span>genericEvents<span class="op">);</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="dt">final</span> <span class="bu">Exception</span> e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">err</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Failed to emit response events: &quot;</span> <span class="op">+</span> e<span class="op">.</span><span class="fu">getMessage</span><span class="op">());</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> responseEvents<span class="op">;</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="event-processing-flow">Event Processing Flow</h2>
<ol>
<li><strong>Precondition Validation</strong>: Ensures application is
properly initialized</li>
<li><strong>Domain Delegation</strong>: Routes event to appropriate
domain aggregate (<code>ByteHot</code>)</li>
<li><strong>Response Collection</strong>: Collects resulting domain
events</li>
<li><strong>Event Emission</strong>: Publishes events through
infrastructure adapters</li>
<li><strong>Error Resilience</strong>: Continues operation even if event
emission fails</li>
</ol>
<h2 id="hot-swap-pipeline-processing">Hot-Swap Pipeline Processing</h2>
<p>The application layer also handles <code>ClassFileChanged</code>
events by executing the complete hot-swap pipeline:</p>
<div class="sourceCode" id="cb5"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/application/ByteHotApplication.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Processes a ClassFileChanged event from file monitoring</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="an">event</span><span class="co"> </span>the class file changed event</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">void</span> <span class="fu">processClassFileChanged</span><span class="op">(</span><span class="dt">final</span> ClassFileChanged event<span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Ensure adapters are initialized</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>adaptersInitialized<span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>            <span class="bu">System</span><span class="op">.</span><span class="fu">err</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Application not initialized - cannot process ClassFileChanged event&quot;</span><span class="op">);</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span><span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Processing ClassFileChanged: &quot;</span> <span class="op">+</span> event<span class="op">.</span><span class="fu">getClassName</span><span class="op">()</span> <span class="op">+</span> <span class="st">&quot; at &quot;</span> <span class="op">+</span> event<span class="op">.</span><span class="fu">getClassFile</span><span class="op">());</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Trigger the complete hot-swap pipeline</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">executeHotSwapPipeline</span><span class="op">(</span>event<span class="op">);</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="dt">final</span> <span class="bu">Exception</span> e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">err</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Failed to process ClassFileChanged event: &quot;</span> <span class="op">+</span> e<span class="op">.</span><span class="fu">getMessage</span><span class="op">());</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>        e<span class="op">.</span><span class="fu">printStackTrace</span><span class="op">();</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="hot-swap-pipeline-execution">Hot-Swap Pipeline Execution</h2>
<p>The core hot-swap pipeline implementation orchestrates bytecode
validation, hot-swap request creation, and class redefinition:</p>
<div class="sourceCode" id="cb6"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/application/ByteHotApplication.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Executes the complete hot<span class="co">-</span>swap pipeline for a class file change</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="an">event</span><span class="co"> </span>the class file changed event</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">protected</span> <span class="dt">void</span> <span class="fu">executeHotSwapPipeline</span><span class="op">(</span><span class="dt">final</span> ClassFileChanged event<span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Step 1: Validate the new bytecode</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Validating bytecode for class: &quot;</span> <span class="op">+</span> event<span class="op">.</span><span class="fu">getClassName</span><span class="op">());</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> BytecodeValidator validator <span class="op">=</span> <span class="kw">new</span> <span class="fu">BytecodeValidator</span><span class="op">();</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> BytecodeValidated validation <span class="op">=</span> validator<span class="op">.</span><span class="fu">validate</span><span class="op">(</span>event<span class="op">.</span><span class="fu">getClassFile</span><span class="op">());</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Bytecode validation successful for: &quot;</span> <span class="op">+</span> event<span class="op">.</span><span class="fu">getClassName</span><span class="op">());</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Step 2: Create hot-swap request</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Creating HotSwapRequested event for: &quot;</span> <span class="op">+</span> event<span class="op">.</span><span class="fu">getClassName</span><span class="op">());</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> HotSwapManager hotSwapManager <span class="op">=</span> <span class="kw">new</span> <span class="fu">HotSwapManager</span><span class="op">();</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Get the current bytecode (mock empty for now since we don&#39;t have class tracking)</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> <span class="dt">byte</span><span class="op">[]</span> originalBytecode <span class="op">=</span> <span class="kw">new</span> <span class="dt">byte</span><span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> HotSwapRequested hotSwapRequest <span class="op">=</span> hotSwapManager<span class="op">.</span><span class="fu">requestHotSwap</span><span class="op">(</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>            event<span class="op">.</span><span class="fu">getClassFile</span><span class="op">(),</span> </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>            validation<span class="op">,</span> </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>            originalBytecode</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">);</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Step 3: Perform class redefinition</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Performing class redefinition for: &quot;</span> <span class="op">+</span> event<span class="op">.</span><span class="fu">getClassName</span><span class="op">());</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> ClassRedefinitionSucceeded result <span class="op">=</span> hotSwapManager<span class="op">.</span><span class="fu">performRedefinition</span><span class="op">(</span>hotSwapRequest<span class="op">);</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Step 4: Log success (event emission would be handled by proper domain flow in production)</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Hot-swap completed successfully for: &quot;</span> <span class="op">+</span> event<span class="op">.</span><span class="fu">getClassName</span><span class="op">()</span> <span class="op">+</span> </span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot; (affected instances: &quot;</span> <span class="op">+</span> result<span class="op">.</span><span class="fu">getAffectedInstances</span><span class="op">()</span> <span class="op">+</span> <span class="st">&quot;)&quot;</span><span class="op">);</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;ClassRedefinitionSucceeded event generated for: &quot;</span> <span class="op">+</span> event<span class="op">.</span><span class="fu">getClassName</span><span class="op">());</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="dt">final</span> BytecodeValidationException e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Handle validation failure</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">err</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Bytecode validation failed for &quot;</span> <span class="op">+</span> event<span class="op">.</span><span class="fu">getClassName</span><span class="op">()</span> <span class="op">+</span> <span class="st">&quot;: &quot;</span> <span class="op">+</span> e<span class="op">.</span><span class="fu">getMessage</span><span class="op">());</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">err</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;BytecodeRejected event generated: &quot;</span> <span class="op">+</span> e<span class="op">.</span><span class="fu">getRejectionEvent</span><span class="op">().</span><span class="fu">getRejectionReason</span><span class="op">());</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="dt">final</span> HotSwapException e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Handle redefinition failure</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">err</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Class redefinition failed for &quot;</span> <span class="op">+</span> event<span class="op">.</span><span class="fu">getClassName</span><span class="op">()</span> <span class="op">+</span> <span class="st">&quot;: &quot;</span> <span class="op">+</span> e<span class="op">.</span><span class="fu">getMessage</span><span class="op">());</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">err</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;ClassRedefinitionFailed event generated: &quot;</span> <span class="op">+</span> e<span class="op">.</span><span class="fu">getFailureEvent</span><span class="op">().</span><span class="fu">getFailureReason</span><span class="op">());</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="dt">final</span> <span class="bu">Exception</span> e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Handle unexpected errors</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">err</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Unexpected error in hot-swap pipeline for &quot;</span> <span class="op">+</span> event<span class="op">.</span><span class="fu">getClassName</span><span class="op">()</span> <span class="op">+</span> <span class="st">&quot;: &quot;</span> <span class="op">+</span> e<span class="op">.</span><span class="fu">getMessage</span><span class="op">());</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>        e<span class="op">.</span><span class="fu">printStackTrace</span><span class="op">();</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="hot-swap-pipeline-flow">Hot-Swap Pipeline Flow</h2>
<p>The complete hot-swap pipeline follows this sequence:</p>
<ol>
<li><strong>File Change Detection</strong>: File monitoring
infrastructure detects <code>.class</code> file modifications</li>
<li><strong>Event Generation</strong>: <code>ClassFileChanged</code>
events are created and routed to the application layer</li>
<li><strong>Pipeline Validation</strong>: Application ensures system is
properly initialized</li>
<li><strong>Bytecode Validation</strong>: <code>BytecodeValidator</code>
verifies hot-swap compatibility</li>
<li><strong>Request Creation</strong>: <code>HotSwapManager</code>
creates <code>HotSwapRequested</code> event with validation results</li>
<li><strong>Class Redefinition</strong>: JVM class redefinition is
performed through <code>HotSwapManager</code></li>
<li><strong>Result Processing</strong>: Success or failure events are
generated and logged</li>
<li><strong>Error Handling</strong>: Comprehensive error handling for
validation and redefinition failures</li>
</ol>
<h2 id="pipeline-error-handling-strategy">Pipeline Error Handling
Strategy</h2>
<p>The pipeline implements robust error handling for different failure
scenarios:</p>
<ul>
<li><strong>Bytecode Validation Failures</strong>: Generates
<code>BytecodeRejected</code> events with detailed rejection
reasons</li>
<li><strong>JVM Redefinition Failures</strong>: Creates
<code>ClassRedefinitionFailed</code> events with JVM error details</li>
<li><strong>Infrastructure Failures</strong>: Logs unexpected errors
while maintaining system stability</li>
<li><strong>Initialization Failures</strong>: Gracefully handles
uninitialized application state</li>
</ul>
<p>This implementation resolves the critical issue where file changes
were detected but not processed through the hot-swap pipeline, ensuring
that runtime class reloading now functions as intended.</p>
<h1 id="adapter-discovery-and-injection-system">Adapter Discovery and
Injection System</h1>
<h2 id="built-in-adapter-registration">Built-in Adapter
Registration</h2>
<p>The application layer knows about and registers core infrastructure
adapters:</p>
<div class="sourceCode" id="cb7"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/application/ByteHotApplication.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Injects the built<span class="co">-</span>in infrastructure adapters</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="at">@SuppressWarnings</span><span class="op">(</span><span class="st">&quot;unchecked&quot;</span><span class="op">)</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="kw">protected</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">injectBuiltInAdapters</span><span class="op">(</span><span class="dt">final</span> Ports ports<span class="op">,</span> <span class="dt">final</span> <span class="bu">Instrumentation</span> instrumentation<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Inject ConfigurationAdapter</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> ConfigurationAdapter configAdapter <span class="op">=</span> <span class="kw">new</span> <span class="fu">ConfigurationAdapter</span><span class="op">();</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        ports<span class="op">.</span><span class="fu">inject</span><span class="op">(</span>ConfigurationPort<span class="op">.</span><span class="fu">class</span><span class="op">,</span> <span class="op">(</span>Adapter<span class="op">&lt;</span>ConfigurationPort<span class="op">&gt;)</span> configAdapter<span class="op">);</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Inject FileWatcherAdapter</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> FileWatcherAdapter fileWatcherAdapter <span class="op">=</span> <span class="kw">new</span> <span class="fu">FileWatcherAdapter</span><span class="op">();</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        ports<span class="op">.</span><span class="fu">inject</span><span class="op">(</span>FileWatcherPort<span class="op">.</span><span class="fu">class</span><span class="op">,</span> <span class="op">(</span>Adapter<span class="op">&lt;</span>FileWatcherPort<span class="op">&gt;)</span> fileWatcherAdapter<span class="op">);</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Inject InstrumentationAdapter (only if instrumentation is available)</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>instrumentation <span class="op">!=</span> <span class="kw">null</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>            <span class="dt">final</span> InstrumentationAdapter instrumentationAdapter <span class="op">=</span> <span class="kw">new</span> <span class="fu">InstrumentationAdapter</span><span class="op">(</span>instrumentation<span class="op">);</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>            ports<span class="op">.</span><span class="fu">inject</span><span class="op">(</span>InstrumentationPort<span class="op">.</span><span class="fu">class</span><span class="op">,</span> <span class="op">(</span>Adapter<span class="op">&lt;</span>InstrumentationPort<span class="op">&gt;)</span> instrumentationAdapter<span class="op">);</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Inject EventEmitterAdapter</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> EventEmitterAdapter eventEmitterAdapter <span class="op">=</span> <span class="kw">new</span> <span class="fu">EventEmitterAdapter</span><span class="op">();</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>        ports<span class="op">.</span><span class="fu">inject</span><span class="op">(</span>EventEmitterPort<span class="op">.</span><span class="fu">class</span><span class="op">,</span> <span class="op">(</span>Adapter<span class="op">&lt;</span>EventEmitterPort<span class="op">&gt;)</span> eventEmitterAdapter<span class="op">);</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Built-in adapters injected successfully&quot;</span><span class="op">);</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="dt">final</span> <span class="bu">Exception</span> e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">err</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Failed to inject built-in adapters: &quot;</span> <span class="op">+</span> e<span class="op">.</span><span class="fu">getMessage</span><span class="op">());</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>        e<span class="op">.</span><span class="fu">printStackTrace</span><span class="op">();</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="core-adapters-registered">Core Adapters Registered</h2>
<ul>
<li><strong>ConfigurationAdapter</strong>: Handles system configuration
access</li>
<li><strong>FileWatcherAdapter</strong>: Monitors file system
changes</li>
<li><strong>InstrumentationAdapter</strong>: Provides JVM
instrumentation capabilities (if available)</li>
<li><strong>EventEmitterAdapter</strong>: Manages event publication and
routing</li>
</ul>
<h1 id="dynamic-adapter-discovery">Dynamic Adapter Discovery</h1>
<h2 id="classpath-scanning-strategy">Classpath Scanning Strategy</h2>
<p>The application automatically discovers additional adapters from the
classpath:</p>
<div class="sourceCode" id="cb8"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/application/ByteHotApplication.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Discovers additional adapters from the classpath</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">protected</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">discoverAdaptersFromClasspath</span><span class="op">(</span><span class="dt">final</span> Ports ports<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> <span class="bu">List</span><span class="op">&lt;</span><span class="bu">Class</span><span class="op">&lt;?&gt;&gt;</span> adapterClasses <span class="op">=</span> <span class="fu">findAdapterClasses</span><span class="op">();</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">final</span> <span class="bu">Class</span><span class="op">&lt;?&gt;</span> adapterClass <span class="op">:</span> adapterClasses<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span><span class="fu">isValidAdapter</span><span class="op">(</span>adapterClass<span class="op">))</span> <span class="op">{</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">instantiateAndInjectAdapter</span><span class="op">(</span>ports<span class="op">,</span> adapterClass<span class="op">);</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>adapterClasses<span class="op">.</span><span class="fu">isEmpty</span><span class="op">())</span> <span class="op">{</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>            <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Discovered &quot;</span> <span class="op">+</span> adapterClasses<span class="op">.</span><span class="fu">size</span><span class="op">()</span> <span class="op">+</span> <span class="st">&quot; additional adapter(s) from classpath&quot;</span><span class="op">);</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="dt">final</span> <span class="bu">Exception</span> e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">err</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Failed to discover adapters from classpath: &quot;</span> <span class="op">+</span> e<span class="op">.</span><span class="fu">getMessage</span><span class="op">());</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="discovery-algorithm">Discovery Algorithm</h2>
<ol>
<li><strong>Package Scanning</strong>: Searches predefined
infrastructure packages</li>
<li><strong>File System Support</strong>: Handles both file system and
JAR-based classes</li>
<li><strong>Validation</strong>: Ensures discovered classes are valid
adapters</li>
<li><strong>Automatic Registration</strong>: Instantiates and injects
valid adapters</li>
</ol>
<h2 id="adapter-validation-logic">Adapter Validation Logic</h2>
<p>Comprehensive validation ensures only proper adapters are
registered:</p>
<div class="sourceCode" id="cb9"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/application/ByteHotApplication.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Checks if a class is a valid adapter</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">protected</span> <span class="dt">static</span> <span class="dt">boolean</span> <span class="fu">isValidAdapter</span><span class="op">(</span><span class="dt">final</span> <span class="bu">Class</span><span class="op">&lt;?&gt;</span> clazz<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> clazz <span class="op">!=</span> <span class="kw">null</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;&amp;</span> <span class="op">!</span>clazz<span class="op">.</span><span class="fu">isInterface</span><span class="op">()</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;&amp;</span> <span class="op">!</span>java<span class="op">.</span><span class="fu">lang</span><span class="op">.</span><span class="fu">reflect</span><span class="op">.</span><span class="fu">Modifier</span><span class="op">.</span><span class="fu">isAbstract</span><span class="op">(</span>clazz<span class="op">.</span><span class="fu">getModifiers</span><span class="op">())</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;&amp;</span> Adapter<span class="op">.</span><span class="fu">class</span><span class="op">.</span><span class="fu">isAssignableFrom</span><span class="op">(</span>clazz<span class="op">)</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;&amp;</span> <span class="bu">Port</span><span class="op">.</span><span class="fu">class</span><span class="op">.</span><span class="fu">isAssignableFrom</span><span class="op">(</span><span class="fu">getPortInterface</span><span class="op">(</span>clazz<span class="op">));</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Validation Criteria</strong>:</p>
<ul>
<li>Must be a concrete class (not interface or abstract)</li>
<li>Must implement the <code>Adapter</code> interface</li>
<li>Must adapt a valid <code>Port</code> interface</li>
<li>Must be instantiable with default constructor</li>
</ul>
<h1 id="file-system-and-jar-scanning-implementation">File System and JAR
Scanning Implementation</h1>
<h2 id="file-system-scanning">File System Scanning</h2>
<p>Recursive directory traversal for development environments:</p>
<div class="sourceCode" id="cb10"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/application/ByteHotApplication.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Scans file system directory for adapter classes</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="kw">protected</span> <span class="dt">static</span> <span class="bu">List</span><span class="op">&lt;</span><span class="bu">Class</span><span class="op">&lt;?&gt;&gt;</span> <span class="fu">scanFileSystemForAdapters</span><span class="op">(</span><span class="dt">final</span> <span class="bu">File</span> directory<span class="op">,</span> <span class="dt">final</span> <span class="bu">String</span> packageName<span class="op">,</span> <span class="dt">final</span> <span class="bu">ClassLoader</span> classLoader<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">List</span><span class="op">&lt;</span><span class="bu">Class</span><span class="op">&lt;?&gt;&gt;</span> adapterClasses <span class="op">=</span> <span class="kw">new</span> <span class="bu">ArrayList</span><span class="op">&lt;&gt;();</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>directory<span class="op">.</span><span class="fu">exists</span><span class="op">()</span> <span class="op">||</span> <span class="op">!</span>directory<span class="op">.</span><span class="fu">isDirectory</span><span class="op">())</span> <span class="op">{</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> adapterClasses<span class="op">;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">File</span><span class="op">[]</span> files <span class="op">=</span> directory<span class="op">.</span><span class="fu">listFiles</span><span class="op">();</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>files <span class="op">!=</span> <span class="kw">null</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">final</span> <span class="bu">File</span> file <span class="op">:</span> files<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>file<span class="op">.</span><span class="fu">isDirectory</span><span class="op">())</span> <span class="op">{</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>                adapterClasses<span class="op">.</span><span class="fu">addAll</span><span class="op">(</span><span class="fu">scanFileSystemForAdapters</span><span class="op">(</span>file<span class="op">,</span> packageName <span class="op">+</span> <span class="st">&quot;.&quot;</span> <span class="op">+</span> file<span class="op">.</span><span class="fu">getName</span><span class="op">(),</span> classLoader<span class="op">));</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>file<span class="op">.</span><span class="fu">getName</span><span class="op">().</span><span class="fu">endsWith</span><span class="op">(</span><span class="st">&quot;.class&quot;</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>                <span class="dt">final</span> <span class="bu">String</span> className <span class="op">=</span> packageName <span class="op">+</span> <span class="st">&quot;.&quot;</span> <span class="op">+</span> file<span class="op">.</span><span class="fu">getName</span><span class="op">().</span><span class="fu">substring</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> file<span class="op">.</span><span class="fu">getName</span><span class="op">().</span><span class="fu">length</span><span class="op">()</span> <span class="op">-</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>                <span class="dt">final</span> <span class="bu">Class</span><span class="op">&lt;?&gt;</span> clazz <span class="op">=</span> <span class="fu">loadClass</span><span class="op">(</span>className<span class="op">,</span> classLoader<span class="op">);</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>clazz <span class="op">!=</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> <span class="fu">isValidAdapter</span><span class="op">(</span>clazz<span class="op">))</span> <span class="op">{</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>                    adapterClasses<span class="op">.</span><span class="fu">add</span><span class="op">(</span>clazz<span class="op">);</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adapterClasses<span class="op">;</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="jar-file-scanning">JAR File Scanning</h2>
<p>Supports deployment scenarios with JAR packaging:</p>
<div class="sourceCode" id="cb11"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/application/ByteHotApplication.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Scans JAR file for adapter classes</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="kw">protected</span> <span class="dt">static</span> <span class="bu">List</span><span class="op">&lt;</span><span class="bu">Class</span><span class="op">&lt;?&gt;&gt;</span> <span class="fu">scanJarForAdapters</span><span class="op">(</span><span class="dt">final</span> <span class="bu">URL</span> jarUrl<span class="op">,</span> <span class="dt">final</span> <span class="bu">String</span> packagePath<span class="op">,</span> <span class="dt">final</span> <span class="bu">ClassLoader</span> classLoader<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">List</span><span class="op">&lt;</span><span class="bu">Class</span><span class="op">&lt;?&gt;&gt;</span> adapterClasses <span class="op">=</span> <span class="kw">new</span> <span class="bu">ArrayList</span><span class="op">&lt;&gt;();</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> <span class="bu">String</span> jarPath <span class="op">=</span> jarUrl<span class="op">.</span><span class="fu">getPath</span><span class="op">().</span><span class="fu">substring</span><span class="op">(</span><span class="dv">5</span><span class="op">,</span> jarUrl<span class="op">.</span><span class="fu">getPath</span><span class="op">().</span><span class="fu">indexOf</span><span class="op">(</span><span class="st">&quot;!&quot;</span><span class="op">));</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> <span class="bu">JarFile</span> jarFile <span class="op">=</span> <span class="kw">new</span> <span class="bu">JarFile</span><span class="op">(</span>jarPath<span class="op">);</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> <span class="bu">Enumeration</span><span class="op">&lt;</span><span class="bu">JarEntry</span><span class="op">&gt;</span> entries <span class="op">=</span> jarFile<span class="op">.</span><span class="fu">entries</span><span class="op">();</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>entries<span class="op">.</span><span class="fu">hasMoreElements</span><span class="op">())</span> <span class="op">{</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>            <span class="dt">final</span> <span class="bu">JarEntry</span> entry <span class="op">=</span> entries<span class="op">.</span><span class="fu">nextElement</span><span class="op">();</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>            <span class="dt">final</span> <span class="bu">String</span> entryName <span class="op">=</span> entry<span class="op">.</span><span class="fu">getName</span><span class="op">();</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>entryName<span class="op">.</span><span class="fu">startsWith</span><span class="op">(</span>packagePath<span class="op">)</span> <span class="op">&amp;&amp;</span> entryName<span class="op">.</span><span class="fu">endsWith</span><span class="op">(</span><span class="st">&quot;.class&quot;</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                <span class="dt">final</span> <span class="bu">String</span> className <span class="op">=</span> entryName<span class="op">.</span><span class="fu">replace</span><span class="op">(</span><span class="ch">&#39;/&#39;</span><span class="op">,</span> <span class="ch">&#39;.&#39;</span><span class="op">).</span><span class="fu">substring</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> entryName<span class="op">.</span><span class="fu">length</span><span class="op">()</span> <span class="op">-</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>                <span class="dt">final</span> <span class="bu">Class</span><span class="op">&lt;?&gt;</span> clazz <span class="op">=</span> <span class="fu">loadClass</span><span class="op">(</span>className<span class="op">,</span> classLoader<span class="op">);</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>clazz <span class="op">!=</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> <span class="fu">isValidAdapter</span><span class="op">(</span>clazz<span class="op">))</span> <span class="op">{</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>                    adapterClasses<span class="op">.</span><span class="fu">add</span><span class="op">(</span>clazz<span class="op">);</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>        jarFile<span class="op">.</span><span class="fu">close</span><span class="op">();</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="dt">final</span> <span class="bu">Exception</span> e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span><span class="op">.</span><span class="fu">err</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Error scanning JAR &quot;</span> <span class="op">+</span> jarUrl <span class="op">+</span> <span class="st">&quot;: &quot;</span> <span class="op">+</span> e<span class="op">.</span><span class="fu">getMessage</span><span class="op">());</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adapterClasses<span class="op">;</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="error-handling-and-resilience">Error Handling and
Resilience</h1>
<h2 id="graceful-degradation-strategy">Graceful Degradation
Strategy</h2>
<p>The application layer implements comprehensive error handling that
allows the system to continue functioning even when some components
fail:</p>
<ul>
<li><strong>Adapter Discovery Failures</strong>: System continues with
built-in adapters</li>
<li><strong>Event Emission Failures</strong>: Core functionality
continues, events logged</li>
<li><strong>Port Resolution Failures</strong>: Clear error messages with
system state preservation</li>
</ul>
<h2 id="initialization-safety">Initialization Safety</h2>
<p>Multiple safety mechanisms ensure robust initialization:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">// State validation</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(!</span>adaptersInitialized<span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">IllegalStateException</span><span class="op">(</span><span class="st">&quot;Application not initialized. Call initialize() with Instrumentation first.&quot;</span><span class="op">);</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">// Exception isolation  </span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span> <span class="op">{</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Critical operations</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="dt">final</span> <span class="bu">Exception</span> e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">System</span><span class="op">.</span><span class="fu">err</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Failed to emit response events: &quot;</span> <span class="op">+</span> e<span class="op">.</span><span class="fu">getMessage</span><span class="op">());</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Continue with degraded functionality</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="integration-points">Integration Points</h1>
<h2 id="domain-layer-integration">Domain Layer Integration</h2>
<ul>
<li>Routes events to domain aggregates
(<code>ByteHot.accept()</code>)</li>
<li>Resolves domain ports through <code>Ports.resolve()</code></li>
<li>Maintains domain purity by handling all infrastructure concerns</li>
</ul>
<h2 id="infrastructure-layer-integration">Infrastructure Layer
Integration</h2>
<ul>
<li>Discovers and instantiates infrastructure adapters</li>
<li>Manages adapter lifecycle and registration</li>
<li>Provides fallback mechanisms for missing adapters</li>
</ul>
<h2 id="external-system-integration">External System Integration</h2>
<ul>
<li>JVM Instrumentation API integration</li>
<li>File system monitoring capabilities</li>
<li>Event emission to external subscribers</li>
</ul>
<h1 id="testing-considerations">Testing Considerations</h1>
<h2 id="unit-testing-strategy">Unit Testing Strategy</h2>
<div class="sourceCode" id="cb13"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="at">@Test</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="fu">should_initialize_built_in_adapters</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Given: Fresh application state</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">Instrumentation</span> mockInstrumentation <span class="op">=</span> <span class="fu">mock</span><span class="op">(</span><span class="bu">Instrumentation</span><span class="op">.</span><span class="fu">class</span><span class="op">);</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// When: Initialization is called</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    ByteHotApplication<span class="op">.</span><span class="fu">initialize</span><span class="op">(</span>mockInstrumentation<span class="op">);</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Then: All built-in adapters should be registered</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assertThat</span><span class="op">(</span>Ports<span class="op">.</span><span class="fu">resolve</span><span class="op">(</span>ConfigurationPort<span class="op">.</span><span class="fu">class</span><span class="op">)).</span><span class="fu">isNotNull</span><span class="op">();</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assertThat</span><span class="op">(</span>Ports<span class="op">.</span><span class="fu">resolve</span><span class="op">(</span>FileWatcherPort<span class="op">.</span><span class="fu">class</span><span class="op">)).</span><span class="fu">isNotNull</span><span class="op">();</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assertThat</span><span class="op">(</span>Ports<span class="op">.</span><span class="fu">resolve</span><span class="op">(</span>EventEmitterPort<span class="op">.</span><span class="fu">class</span><span class="op">)).</span><span class="fu">isNotNull</span><span class="op">();</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="integration-testing-approach">Integration Testing Approach</h2>
<ul>
<li>Test with real JVM instrumentation</li>
<li>Verify adapter discovery in various deployment scenarios</li>
<li>Validate event routing end-to-end</li>
</ul>
<h1 id="configuration-and-extensibility">Configuration and
Extensibility</h1>
<h2 id="adapter-package-configuration">Adapter Package
Configuration</h2>
<p>The system scans these predefined packages for additional
adapters:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="dt">final</span> <span class="bu">String</span><span class="op">[]</span> infraPackages <span class="op">=</span> <span class="op">{</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;org.acmsl.bytehot.infrastructure&quot;</span><span class="op">,</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;org.acmsl.bytehot.adapters&quot;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<h2 id="extension-points">Extension Points</h2>
<ul>
<li>Custom adapters can be added by implementing the
<code>Adapter</code> interface</li>
<li>New infrastructure concerns can be addressed through additional
ports</li>
<li>Event handling can be extended through custom event emitter
implementations</li>
</ul>
<h1 id="performance-considerations">Performance Considerations</h1>
<h2 id="initialization-optimization">Initialization Optimization</h2>
<ul>
<li>Double-checked locking minimizes synchronization overhead</li>
<li>Lazy initialization reduces startup time</li>
<li>Classpath scanning is performed only once during initialization</li>
</ul>
<h2 id="runtime-efficiency">Runtime Efficiency</h2>
<ul>
<li>Port resolution is cached through the Ports infrastructure</li>
<li>Event routing has minimal overhead</li>
<li>Adapter discovery results are cached for the application
lifetime</li>
</ul>
<h1 id="future-evolution">Future Evolution</h1>
<h2 id="anticipated-enhancements">Anticipated Enhancements</h2>
<ul>
<li>Configuration-driven adapter discovery</li>
<li>Plugin architecture for third-party adapters</li>
<li>Hot-pluggable adapter replacement</li>
<li>Metrics and monitoring integration</li>
</ul>
<h2 id="architectural-flexibility">Architectural Flexibility</h2>
<p>The loose coupling between application and infrastructure layers
enables:</p>
<ul>
<li>Easy replacement of infrastructure implementations</li>
<li>Addition of new adapter types without application changes</li>
<li>Testing with mock infrastructure implementations</li>
</ul>
<h1 id="related-documentation">Related Documentation</h1>
<ul>
<li><a href="./Ports.org">Ports</a>: Domain port resolution
infrastructure</li>
<li><a href="./ByteHot.org">ByteHot</a>: Core domain aggregate</li>
<li><a
href="./infrastructure/ConfigurationAdapter.org">ConfigurationAdapter</a>:
Configuration infrastructure</li>
<li><a
href="./infrastructure/FileWatcherAdapter.org">FileWatcherAdapter</a>:
File monitoring infrastructure</li>
<li><a href="../flows/adapter-discovery-flow.org">Adapter Discovery
Flow</a>: Complete discovery process documentation</li>
</ul>
<h1 id="invariants-and-constraints">Invariants and Constraints</h1>
<h2 id="initialization-invariants">Initialization Invariants</h2>
<ul>
<li>Application must be initialized before processing events</li>
<li>Instrumentation must be provided during initialization</li>
<li>Built-in adapters must be successfully registered</li>
</ul>
<h2 id="runtime-constraints">Runtime Constraints</h2>
<ul>
<li>Adapter discovery failures should not prevent system startup</li>
<li>Event emission failures should not interrupt core functionality</li>
<li>Port resolution must always succeed for built-in adapters</li>
</ul>
<p>The ByteHotApplication serves as the crucial orchestration point that
transforms ByteHot from a collection of components into a cohesive,
event-driven system capable of runtime bytecode manipulation.</p>
</main>
<div class="footer">
    ByteHot - Revolutionary JVM Hot-Swapping | 
    <a href="https://github.com/rydnr/bytehot">GitHub</a> | 
    <a href="https://rydnr.github.io/bytehot/docs/">Documentation</a> | 
    <a href="https://rydnr.github.io/bytehot/javadocs/">API Docs</a>
</div>
</body></html>
