<!DOCTYPE html>
<html>
<head>
    <title>User - ByteHot Documentation</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
<div class="navigation">
    <a href="../index.html">üè† Home</a>
    <a href="../implementation.html">üèóÔ∏è Implementation</a>
    <a href="../journal.html">üìî Journal</a>
    <a href="../docs/">üìö Docs</a>
    <a href="../javadocs/">üìñ Javadocs</a>
    <a href="https://github.com/rydnr/bytehot">üîó GitHub</a>
</div>
<main>
<h1 id="overview">Overview</h1>
<p>The <code>User</code> class is the aggregate root for ByteHot's user
management domain, implementing comprehensive user lifecycle operations
with EventSourcing capabilities.</p>
<h1 id="class-responsibilities">Class Responsibilities</h1>
<h2 id="primary-responsibilities">Primary Responsibilities</h2>
<ul>
<li>Serve as the aggregate root for all user-related operations</li>
<li>Handle user registration, authentication, and session
management</li>
<li>Provide EventSourcing reconstruction from event history</li>
<li>Maintain user state through immutable operations</li>
</ul>
<h2 id="secondary-responsibilities">Secondary Responsibilities</h2>
<ul>
<li>Coordinate with EventStorePort for event persistence</li>
<li>Support auto-discovery of user information</li>
<li>Generate unique session identifiers</li>
<li>Enforce user business invariants</li>
</ul>
<h1 id="architecture-context">Architecture Context</h1>
<p>The User aggregate follows Domain-Driven Design principles:</p>
<ul>
<li><strong><strong>Aggregate Root</strong></strong>: Central entry
point for user domain operations</li>
<li><strong><strong>EventSourcing</strong></strong>: Complete state
reconstruction from event history</li>
<li><strong><strong>Primary Ports</strong></strong>: Accepts domain
events and produces response events</li>
<li><strong><strong>Clean Boundaries</strong></strong>: No
infrastructure dependencies, pure domain logic</li>
</ul>
<h1 id="key-operations">Key Operations</h1>
<h2 id="primary-ports-event-handlers">Primary Ports (Event
Handlers)</h2>
<h3
id="acceptuserregistrationrequested">accept(UserRegistrationRequested)</h3>
<p>Handles user registration requests.</p>
<div class="sourceCode" id="cb1"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/domain/User.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">static</span> DomainResponseEvent<span class="op">&lt;</span>UserRegistrationRequested<span class="op">&gt;</span> <span class="fu">accept</span><span class="op">(</span><span class="dt">final</span> UserRegistrationRequested event<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Create user profile</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> UserProfile profile <span class="op">=</span> UserProfile<span class="op">.</span><span class="fu">defaultProfile</span><span class="op">(</span>event<span class="op">.</span><span class="fu">getUserId</span><span class="op">());</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Create new user</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> User user <span class="op">=</span> <span class="kw">new</span> <span class="fu">User</span><span class="op">(</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        event<span class="op">.</span><span class="fu">getUserId</span><span class="op">(),</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        profile<span class="op">,</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        UserPreferences<span class="op">.</span><span class="fu">defaults</span><span class="op">(),</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        UserStatistics<span class="op">.</span><span class="fu">empty</span><span class="op">(),</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        Instant<span class="op">.</span><span class="fu">now</span><span class="op">(),</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        Instant<span class="op">.</span><span class="fu">now</span><span class="op">(),</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1L</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">);</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> UserRegistered<span class="op">.</span><span class="fu">of</span><span class="op">(</span>event<span class="op">,</span> profile<span class="op">,</span> event<span class="op">.</span><span class="fu">getSource</span><span class="op">());</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3
id="acceptuserauthenticationrequested">accept(UserAuthenticationRequested)</h3>
<p>Handles user authentication with auto-registration support.</p>
<p>public static DomainResponseEvent&lt;UserAuthenticationRequested&gt;
accept(final UserAuthenticationRequested event) { // Try to reconstruct
user from events final User user =
reconstructFromEvents(event.getUserId());</p>
<p>if (user == null) { // User doesn't exist, auto-register first final
UserRegistrationRequested registrationEvent = new
UserRegistrationRequested( event.getUserId(),
UserRegistered.UserRegistrationSource.AUTOMATIC );
accept(registrationEvent); }</p>
<p>// Get user profile (after potential registration) final User
authenticatedUser = reconstructFromEvents(event.getUserId()); final
UserProfile profile = authenticatedUser != null ?
authenticatedUser.getProfile() :
UserProfile.defaultProfile(event.getUserId());</p>
<p>return UserAuthenticated.success(event, profile); }</p>
<h3
id="acceptusersessionstartrequested">accept(UserSessionStartRequested)</h3>
<p>Handles user session initiation.</p>
<div class="sourceCode" id="cb2"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/domain/User.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">static</span> DomainResponseEvent<span class="op">&lt;</span>UserSessionStartRequested<span class="op">&gt;</span> <span class="fu">accept</span><span class="op">(</span><span class="dt">final</span> UserSessionStartRequested event<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Reconstruct user to get current state</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> User user <span class="op">=</span> <span class="fu">reconstructFromEvents</span><span class="op">(</span>event<span class="op">.</span><span class="fu">getUserId</span><span class="op">());</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>user <span class="op">==</span> <span class="kw">null</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">IllegalStateException</span><span class="op">(</span><span class="st">&quot;Cannot start session for non-existent user: &quot;</span> <span class="op">+</span> event<span class="op">.</span><span class="fu">getUserId</span><span class="op">());</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Create session</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> sessionId <span class="op">=</span> <span class="fu">generateSessionId</span><span class="op">();</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> UserSession session <span class="op">=</span> UserSession<span class="op">.</span><span class="fu">start</span><span class="op">(</span>sessionId<span class="op">,</span> event<span class="op">.</span><span class="fu">getUserId</span><span class="op">(),</span> Instant<span class="op">.</span><span class="fu">now</span><span class="op">(),</span> event<span class="op">.</span><span class="fu">getEnvironment</span><span class="op">());</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> UserSessionStarted<span class="op">.</span><span class="fu">of</span><span class="op">(</span>event<span class="op">,</span> session<span class="op">);</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="eventsourcing-operations">EventSourcing Operations</h2>
<h3 id="reconstructfromeventsuserid">reconstructFromEvents(UserId)</h3>
<p>Reconstructs user state from complete event history.</p>
<p>protected static User reconstructFromEvents(final UserId userId) {
try { final EventStorePort eventStore =
Ports.resolve(EventStorePort.class); final
List&lt;VersionedDomainEvent&gt; events =
eventStore.getEventsForAggregate("user", userId.getValue());</p>
<p>if (events.isEmpty()) { return null; }</p>
<p>User user = null; for (final VersionedDomainEvent event : events) {
user = applyEvent(user, event); }</p>
<p>return user; } catch (final Exception e) { // If EventStore is not
available, return null return null; } }</p>
<h3 id="applyeventuser-versioneddomainevent">applyEvent(User,
VersionedDomainEvent)</h3>
<p>Applies individual events to rebuild user state.</p>
<div class="sourceCode" id="cb3"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/domain/User.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">protected</span> <span class="dt">static</span> User <span class="fu">applyEvent</span><span class="op">(</span><span class="dt">final</span> User currentUser<span class="op">,</span> <span class="dt">final</span> VersionedDomainEvent event<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>event <span class="kw">instanceof</span> UserRegistered<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> UserRegistered registeredEvent <span class="op">=</span> <span class="op">(</span>UserRegistered<span class="op">)</span> event<span class="op">;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">new</span> <span class="fu">User</span><span class="op">(</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>            registeredEvent<span class="op">.</span><span class="fu">getUserProfile</span><span class="op">().</span><span class="fu">getUserId</span><span class="op">(),</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>            registeredEvent<span class="op">.</span><span class="fu">getUserProfile</span><span class="op">(),</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>            UserPreferences<span class="op">.</span><span class="fu">defaults</span><span class="op">(),</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>            UserStatistics<span class="op">.</span><span class="fu">empty</span><span class="op">(),</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>            Instant<span class="op">.</span><span class="fu">now</span><span class="op">(),</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>            Instant<span class="op">.</span><span class="fu">now</span><span class="op">(),</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1L</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">);</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>event <span class="kw">instanceof</span> UserAuthenticated<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> UserAuthenticated authEvent <span class="op">=</span> <span class="op">(</span>UserAuthenticated<span class="op">)</span> event<span class="op">;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>currentUser <span class="op">==</span> <span class="kw">null</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">IllegalStateException</span><span class="op">(</span><span class="st">&quot;Cannot authenticate user without registration event&quot;</span><span class="op">);</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">new</span> <span class="fu">User</span><span class="op">(</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>            currentUser<span class="op">.</span><span class="fu">userId</span><span class="op">,</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>            currentUser<span class="op">.</span><span class="fu">profile</span><span class="op">,</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>            currentUser<span class="op">.</span><span class="fu">preferences</span><span class="op">,</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>            currentUser<span class="op">.</span><span class="fu">statistics</span><span class="op">,</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>            currentUser<span class="op">.</span><span class="fu">registeredAt</span><span class="op">,</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>            Instant<span class="op">.</span><span class="fu">now</span><span class="op">(),</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>            currentUser<span class="op">.</span><span class="fu">version</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">);</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>event <span class="kw">instanceof</span> UserSessionStarted<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> UserSessionStarted sessionEvent <span class="op">=</span> <span class="op">(</span>UserSessionStarted<span class="op">)</span> event<span class="op">;</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>currentUser <span class="op">==</span> <span class="kw">null</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">IllegalStateException</span><span class="op">(</span><span class="st">&quot;Cannot start session without user registration&quot;</span><span class="op">);</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Update statistics with new session</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>        <span class="dt">final</span> UserStatistics updatedStats <span class="op">=</span> currentUser<span class="op">.</span><span class="fu">statistics</span><span class="op">.</span><span class="fu">recordSession</span><span class="op">(</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>            sessionEvent<span class="op">.</span><span class="fu">getSession</span><span class="op">().</span><span class="fu">getStartedAt</span><span class="op">(),</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>            sessionEvent<span class="op">.</span><span class="fu">getSession</span><span class="op">().</span><span class="fu">getDuration</span><span class="op">()</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        <span class="op">);</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">new</span> <span class="fu">User</span><span class="op">(</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>            currentUser<span class="op">.</span><span class="fu">userId</span><span class="op">,</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>            currentUser<span class="op">.</span><span class="fu">profile</span><span class="op">,</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>            currentUser<span class="op">.</span><span class="fu">preferences</span><span class="op">,</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>            updatedStats<span class="op">,</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>            currentUser<span class="op">.</span><span class="fu">registeredAt</span><span class="op">,</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>            Instant<span class="op">.</span><span class="fu">now</span><span class="op">(),</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>            currentUser<span class="op">.</span><span class="fu">version</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>        <span class="op">);</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Unknown event type, return current state</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> currentUser<span class="op">;</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="state-management">State Management</h1>
<p>The User aggregate maintains the following state:</p>
<h2 id="core-identity">Core Identity</h2>
<ul>
<li><code>UserId userId</code>: Unique user identifier with
auto-discovery capabilities</li>
<li><code>UserProfile profile</code>: User profile information (name,
email, avatar)</li>
<li><code>Instant registeredAt</code>: When the user was first
registered</li>
<li><code>Instant lastActiveAt</code>: Most recent activity
timestamp</li>
</ul>
<h2 id="user-preferences">User Preferences</h2>
<ul>
<li><code>UserPreferences preferences</code>: Type-safe user
configuration storage</li>
<li>Includes ByteHot-specific settings and customizations</li>
<li>Supports boolean, string, and integer preference types</li>
</ul>
<h2 id="analytics">Analytics</h2>
<ul>
<li><code>UserStatistics statistics</code>: Hot-swap usage analytics and
metrics</li>
<li>Tracks hot-swap operations, success rates, time savings</li>
<li>Provides derived metrics for efficiency analysis</li>
</ul>
<h2 id="versioning">Versioning</h2>
<ul>
<li><code>long version</code>: Aggregate version for EventSourcing</li>
<li>Incremented with each state transition</li>
<li>Used for optimistic concurrency control</li>
</ul>
<h1 id="invariants">Invariants</h1>
<p>The User aggregate maintains several business invariants:</p>
<h2 id="identity-invariants">Identity Invariants</h2>
<ul>
<li>User ID cannot be null or empty</li>
<li>User ID must be valid format (email, username, or generated)</li>
<li>Each user must have a unique identifier</li>
</ul>
<h2 id="state-invariants">State Invariants</h2>
<ul>
<li>Registration timestamp cannot be in the future</li>
<li>Last active timestamp cannot be before registration</li>
<li>Version number must be positive and monotonically increasing</li>
</ul>
<h2 id="eventsourcing-invariants">EventSourcing Invariants</h2>
<ul>
<li>User state can always be reconstructed from event history</li>
<li>Events must be applied in chronological order</li>
<li>Event application must be idempotent and deterministic</li>
</ul>
<h2 id="session-invariants">Session Invariants</h2>
<ul>
<li>Sessions can only be started for existing users</li>
<li>Session IDs must be unique within the system</li>
<li>Environment snapshots must be captured for each session</li>
</ul>
<h1 id="auto-discovery-features">Auto-Discovery Features</h1>
<p>The User aggregate supports intelligent user discovery:</p>
<h2 id="git-configuration-discovery">Git Configuration Discovery</h2>
<ul>
<li>Reads user.name and user.email from Git configuration</li>
<li>Creates UserProfile automatically from Git information</li>
<li>Integrates with development workflow seamlessly</li>
</ul>
<h2 id="environment-variable-detection">Environment Variable
Detection</h2>
<ul>
<li>Detects USER, USERNAME, LOGNAME environment variables</li>
<li>Provides fallback identification when Git is unavailable</li>
<li>Supports various operating system conventions</li>
</ul>
<h2 id="email-based-identification">Email-Based Identification</h2>
<ul>
<li>Extracts display names from email addresses intelligently</li>
<li>Handles common email formats and conventions</li>
<li>Provides user-friendly display names automatically</li>
</ul>
<h1 id="integration-points">Integration Points</h1>
<h2 id="eventstoreport-integration">EventStorePort Integration</h2>
<ul>
<li>Uses EventStorePort for event persistence and retrieval</li>
<li>Supports aggregate reconstruction from stored events</li>
<li>Handles EventStore unavailability gracefully</li>
</ul>
<h2 id="value-object-composition">Value Object Composition</h2>
<ul>
<li>Composes with UserId, UserProfile, UserPreferences, UserStatistics,
UserSession</li>
<li>Maintains immutability through value object patterns</li>
<li>Provides factory methods for object creation</li>
</ul>
<h2 id="domain-event-production">Domain Event Production</h2>
<ul>
<li>Produces UserRegistered, UserAuthenticated, UserSessionStarted
events</li>
<li>Follows request/response event patterns consistently</li>
<li>Maintains event causality and correlation</li>
</ul>
<h1 id="error-handling">Error Handling</h1>
<h2 id="registration-errors">Registration Errors</h2>
<ul>
<li>Validates user information before registration</li>
<li>Handles duplicate registration attempts gracefully</li>
<li>Provides meaningful error messages for validation failures</li>
</ul>
<h2 id="authentication-errors">Authentication Errors</h2>
<ul>
<li>Supports auto-registration for non-existent users</li>
<li>Handles authentication failures with appropriate responses</li>
<li>Maintains security while providing usability</li>
</ul>
<h2 id="session-errors">Session Errors</h2>
<ul>
<li>Validates session requirements before creation</li>
<li>Handles environment capture failures gracefully</li>
<li>Provides session management error recovery</li>
</ul>
<h1 id="performance-considerations">Performance Considerations</h1>
<h2 id="memory-management">Memory Management</h2>
<ul>
<li>Uses weak references where appropriate for instance tracking</li>
<li>Implements efficient state reconstruction algorithms</li>
<li>Minimizes object creation during event replay</li>
</ul>
<h2 id="concurrent-access">Concurrent Access</h2>
<ul>
<li>Supports thread-safe aggregate reconstruction</li>
<li>Handles concurrent user operations safely</li>
<li>Uses atomic operations for consistency</li>
</ul>
<h2 id="caching-strategy">Caching Strategy</h2>
<ul>
<li>EventStore handles event caching for performance</li>
<li>User instances are reconstructed on demand</li>
<li>Avoids long-lived user object references</li>
</ul>
<h1 id="testing-strategy">Testing Strategy</h1>
<p>The User aggregate is thoroughly tested using ByteHot's event-driven
testing framework:</p>
<h2 id="event-driven-tests">Event-Driven Tests</h2>
<ul>
<li>Tests use actual domain events instead of mocks</li>
<li>Realistic test scenarios through event sequences</li>
<li>Bug reproduction through captured event history</li>
</ul>
<h2 id="state-reconstruction-tests">State Reconstruction Tests</h2>
<ul>
<li>Verifies complete aggregate reconstruction from events</li>
<li>Tests event application ordering and consistency</li>
<li>Validates invariant preservation during reconstruction</li>
</ul>
<h2 id="auto-discovery-tests">Auto-Discovery Tests</h2>
<ul>
<li>Tests Git configuration integration scenarios</li>
<li>Validates environment variable detection logic</li>
<li>Verifies fallback behavior when auto-discovery fails</li>
</ul>
<h1 id="future-enhancements">Future Enhancements</h1>
<h2 id="advanced-analytics">Advanced Analytics</h2>
<ul>
<li>More sophisticated usage pattern analysis</li>
<li>Machine learning for user behavior prediction</li>
<li>Advanced metrics and reporting capabilities</li>
</ul>
<h2 id="enhanced-auto-discovery">Enhanced Auto-Discovery</h2>
<ul>
<li>Integration with additional identity providers</li>
<li>More sophisticated email parsing and name extraction</li>
<li>Support for enterprise directory services</li>
</ul>
<h2 id="workflow-integration">Workflow Integration</h2>
<ul>
<li>Integration with issue tracking systems</li>
<li>Support for team collaboration features</li>
<li>Advanced session sharing and coordination</li>
</ul>
<p>The User aggregate represents the foundation of ByteHot's user-aware
operations, providing comprehensive user management while maintaining
strict architectural boundaries and EventSourcing capabilities.</p>
</main>
<div class="footer">
    ByteHot - Revolutionary JVM Hot-Swapping | 
    <a href="https://github.com/rydnr/bytehot">GitHub</a> | 
    <a href="https://rydnr.github.io/bytehot/docs/">Documentation</a> | 
    <a href="https://rydnr.github.io/bytehot/javadocs/">API Docs</a>
</div>
</body></html>
