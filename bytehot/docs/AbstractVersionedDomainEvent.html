<!DOCTYPE html>
<html>
<head>
    <title>AbstractVersionedDomainEvent - ByteHot Documentation</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
<div class="navigation">
    <a href="../index.html">🏠 Home</a>
    <a href="../implementation.html">🏗️ Implementation</a>
    <a href="../journal.html">📔 Journal</a>
    <a href="../docs/">📚 Docs</a>
    <a href="../javadocs/">📖 Javadocs</a>
    <a href="https://github.com/rydnr/bytehot">🔗 GitHub</a>
</div>
<main>
<h1 id="overview">Overview</h1>
<p>The <code>AbstractVersionedDomainEvent</code> class serves as
ByteHot's foundational base class for all versioned domain events,
providing comprehensive event sourcing infrastructure and metadata
management capabilities. This critical abstract class encapsulates all
event sourcing concerns including aggregate versioning, causal chain
management, temporal tracking, user context preservation, and
correlation support, enabling rich domain events with complete audit
trails and system state reconstruction capabilities. As the cornerstone
of ByteHot's event-driven architecture, it ensures consistent event
metadata handling while providing sophisticated factory methods for
event creation and lifecycle management.</p>
<h1 id="domain-architecture-role">Domain Architecture Role</h1>
<h2 id="event-sourcing-foundation">Event Sourcing Foundation</h2>
<p>AbstractVersionedDomainEvent provides the fundamental event sourcing
infrastructure:</p>
<ul>
<li>Encapsulates comprehensive event metadata including versioning and
causal relationships</li>
<li>Ensures consistent handling of aggregate boundaries and versioning
across all domain events</li>
<li>Provides factory methods for proper event creation with complete
metadata preservation</li>
<li>Acts as the foundation for complete system state reconstruction and
audit trail capabilities</li>
</ul>
<h2 id="domain-event-consistency">Domain Event Consistency</h2>
<p>The class ensures consistent domain event structure:</p>
<ul>
<li>Standardizes event metadata across all domain events in the
system</li>
<li>Provides unified approach to event identification, versioning, and
correlation</li>
<li>Ensures proper aggregate boundary respect and concurrency control
mechanisms</li>
<li>Enables sophisticated event sourcing patterns throughout the entire
domain model</li>
</ul>
<h2 id="metadata-management-hub">Metadata Management Hub</h2>
<p>The implementation serves as a comprehensive metadata management
hub:</p>
<ul>
<li>Manages complex event sourcing metadata through clean
abstractions</li>
<li>Provides factory methods for different event creation scenarios and
contexts</li>
<li>Ensures proper causal chain maintenance and event correlation
capabilities</li>
<li>Supports sophisticated temporal analysis and debugging through rich
metadata</li>
</ul>
<h1 id="core-event-sourcing-infrastructure">Core Event Sourcing
Infrastructure</h1>
<h2 id="comprehensive-event-metadata-structure">Comprehensive Event
Metadata Structure</h2>
<div class="sourceCode" id="cb1"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/domain/events/AbstractVersionedDomainEvent.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Unique identifier for this event instance enabling precise event tracking</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">@Getter</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="dt">final</span> <span class="bu">String</span> eventId<span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Type of aggregate this event belongs to for aggregate boundary management</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="at">@Getter</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="dt">final</span> <span class="bu">String</span> aggregateType<span class="op">;</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Unique identifier of the aggregate instance for precise aggregate targeting</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="at">@Getter</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="dt">final</span> <span class="bu">String</span> aggregateId<span class="op">;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Version of this event for the aggregate enabling optimistic concurrency control</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="at">@Getter</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="dt">final</span> <span class="dt">long</span> aggregateVersion<span class="op">;</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Timestamp when the event occurred for temporal analysis and ordering</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="at">@Getter</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="dt">final</span> Instant timestamp<span class="op">;</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> ID of the previous event in this aggregate<span class="co">&#39;</span>s history for causal chain maintenance</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="at">@Getter</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="dt">final</span> <span class="bu">String</span> previousEventId<span class="op">;</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Version of the event schema for migration and evolution support</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="at">@Getter</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="dt">final</span> <span class="dt">int</span> schemaVersion<span class="op">;</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> User who triggered this event for user context and audit trails</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="at">@Getter</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="dt">final</span> <span class="bu">String</span> userId<span class="op">;</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Correlation ID for tracing related events across workflows and processes</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="at">@Getter</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="dt">final</span> <span class="bu">String</span> correlationId<span class="op">;</span></span></code></pre></div>
<h2 id="primary-constructor-with-complete-metadata">Primary Constructor
with Complete Metadata</h2>
<div class="sourceCode" id="cb2"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/domain/events/AbstractVersionedDomainEvent.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Primary constructor with all event sourcing parameters for complete metadata control</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> This constructor enables precise control over all event sourcing aspects</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="an">eventId</span><span class="co"> </span>unique identifier for this event instance</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">aggregateType</span><span class="co"> </span>type of aggregate this event belongs to</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">aggregateId</span><span class="co"> </span>unique identifier of the aggregate instance</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">aggregateVersion</span><span class="co"> </span>version of this event for the aggregate</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">timestamp</span><span class="co"> </span>when the event occurred</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">previousEventId</span><span class="co"> </span>ID of the previous event in this aggregate<span class="co">&#39;</span>s history</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">schemaVersion</span><span class="co"> </span>version of the event schema for evolution support</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">userId</span><span class="co"> </span>user who triggered this event</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">correlationId</span><span class="co"> </span>correlation ID for tracing related events</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="kw">protected</span> <span class="fu">AbstractVersionedDomainEvent</span><span class="op">(</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> eventId<span class="op">,</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> aggregateType<span class="op">,</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> aggregateId<span class="op">,</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="dt">long</span> aggregateVersion<span class="op">,</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> Instant timestamp<span class="op">,</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> previousEventId<span class="op">,</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="dt">int</span> schemaVersion<span class="op">,</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> userId<span class="op">,</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> correlationId</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="fu">eventId</span> <span class="op">=</span> eventId<span class="op">;</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="fu">aggregateType</span> <span class="op">=</span> aggregateType<span class="op">;</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="fu">aggregateId</span> <span class="op">=</span> aggregateId<span class="op">;</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="fu">aggregateVersion</span> <span class="op">=</span> aggregateVersion<span class="op">;</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="fu">timestamp</span> <span class="op">=</span> timestamp<span class="op">;</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="fu">previousEventId</span> <span class="op">=</span> previousEventId<span class="op">;</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="fu">schemaVersion</span> <span class="op">=</span> schemaVersion<span class="op">;</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="fu">userId</span> <span class="op">=</span> userId<span class="op">;</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="fu">correlationId</span> <span class="op">=</span> correlationId<span class="op">;</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="simplified-metadata-based-constructor">Simplified Metadata-Based
Constructor</h2>
<div class="sourceCode" id="cb3"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/domain/events/AbstractVersionedDomainEvent.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Constructor that takes EventMetadata for simplified event creation with encapsulated metadata</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> This provides clean separation between event sourcing metadata and domain event data</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="an">metadata</span><span class="co"> </span>the comprehensive event metadata encapsulating all event sourcing concerns</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="kw">protected</span> <span class="fu">AbstractVersionedDomainEvent</span><span class="op">(</span><span class="dt">final</span> EventMetadata metadata<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">(</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        metadata<span class="op">.</span><span class="fu">getEventId</span><span class="op">(),</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        metadata<span class="op">.</span><span class="fu">getAggregateType</span><span class="op">(),</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        metadata<span class="op">.</span><span class="fu">getAggregateId</span><span class="op">(),</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        metadata<span class="op">.</span><span class="fu">getAggregateVersion</span><span class="op">(),</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        metadata<span class="op">.</span><span class="fu">getTimestamp</span><span class="op">(),</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        metadata<span class="op">.</span><span class="fu">getPreviousEventId</span><span class="op">(),</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        metadata<span class="op">.</span><span class="fu">getSchemaVersion</span><span class="op">(),</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        metadata<span class="op">.</span><span class="fu">getUserId</span><span class="op">(),</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        metadata<span class="op">.</span><span class="fu">getCorrelationId</span><span class="op">()</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">);</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="factory-methods-and-event-creation-strategies">Factory Methods
and Event Creation Strategies</h1>
<h2 id="new-aggregate-event-creation">New Aggregate Event Creation</h2>
<div class="sourceCode" id="cb4"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/domain/events/AbstractVersionedDomainEvent.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Factory method to create event metadata for new aggregates with proper initialization</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> This is used when creating the first event for a new aggregate instance</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="an">aggregateType</span><span class="co"> </span>the type of aggregate being created</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">aggregateId</span><span class="co"> </span>the unique identifier of the aggregate instance</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@return</span> metadata configured for the first event of a new aggregate</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="kw">protected</span> <span class="dt">static</span> EventMetadata <span class="fu">createMetadataForNewAggregate</span><span class="op">(</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> aggregateType<span class="op">,</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> aggregateId</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> EventMetadata<span class="op">.</span><span class="fu">forNewAggregate</span><span class="op">(</span>aggregateType<span class="op">,</span> aggregateId<span class="op">);</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="existing-aggregate-event-creation">Existing Aggregate Event
Creation</h2>
<div class="sourceCode" id="cb5"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/domain/events/AbstractVersionedDomainEvent.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Factory method to create event metadata for existing aggregates with proper versioning</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> This maintains continuity in the event stream for existing aggregate instances</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="an">aggregateType</span><span class="co"> </span>the type of aggregate</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">aggregateId</span><span class="co"> </span>the unique identifier of the aggregate instance</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">previousEventId</span><span class="co"> </span>the ID of the previous event for causal chain maintenance</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">currentVersion</span><span class="co"> </span>the current version of the aggregate for proper versioning</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@return</span> metadata configured for the next event in an existing aggregate<span class="co">&#39;</span>s lifecycle</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="kw">protected</span> <span class="dt">static</span> EventMetadata <span class="fu">createMetadataForExistingAggregate</span><span class="op">(</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> aggregateType<span class="op">,</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> aggregateId<span class="op">,</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> previousEventId<span class="op">,</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="dt">long</span> currentVersion</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> EventMetadata<span class="op">.</span><span class="fu">forExistingAggregate</span><span class="op">(</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        aggregateType<span class="op">,</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        aggregateId<span class="op">,</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>        previousEventId<span class="op">,</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>        currentVersion</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">);</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="user-contextualized-event-creation">User-Contextualized Event
Creation</h2>
<div class="sourceCode" id="cb6"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/domain/events/AbstractVersionedDomainEvent.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Factory method to create event metadata with comprehensive user context</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> This enables user<span class="co">-</span>specific processing and personalized event handling</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="an">aggregateType</span><span class="co"> </span>the type of aggregate</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">aggregateId</span><span class="co"> </span>the unique identifier of the aggregate instance</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">previousEventId</span><span class="co"> </span>the ID of the previous event <span class="co">(</span>null for first event<span class="co">)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">currentVersion</span><span class="co"> </span>the current version of the aggregate <span class="co">(0</span> for first event<span class="co">)</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">userId</span><span class="co"> </span>the user who triggered this event for audit and personalization</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@return</span> metadata with user context for personalized event processing</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="kw">protected</span> <span class="dt">static</span> EventMetadata <span class="fu">createMetadataWithUser</span><span class="op">(</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> aggregateType<span class="op">,</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> aggregateId<span class="op">,</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> previousEventId<span class="op">,</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="dt">long</span> currentVersion<span class="op">,</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> userId</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> EventMetadata<span class="op">.</span><span class="fu">withUser</span><span class="op">(</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        aggregateType<span class="op">,</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>        aggregateId<span class="op">,</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>        previousEventId<span class="op">,</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>        currentVersion<span class="op">,</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>        userId</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">);</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="correlation-enhanced-event-creation">Correlation-Enhanced Event
Creation</h2>
<div class="sourceCode" id="cb7"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/domain/events/AbstractVersionedDomainEvent.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Factory method to create event metadata with correlation for cross<span class="co">-</span>workflow tracking</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> This enables sophisticated event correlation and distributed tracing capabilities</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="an">aggregateType</span><span class="co"> </span>the type of aggregate</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">aggregateId</span><span class="co"> </span>the unique identifier of the aggregate instance</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">previousEventId</span><span class="co"> </span>the ID of the previous event <span class="co">(</span>null for first event<span class="co">)</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">currentVersion</span><span class="co"> </span>the current version of the aggregate <span class="co">(0</span> for first event<span class="co">)</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">userId</span><span class="co"> </span>the user who triggered this event</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">correlationId</span><span class="co"> </span>the correlation ID for tracing related events across workflows</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@return</span> metadata with correlation support for distributed tracing</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="kw">protected</span> <span class="dt">static</span> EventMetadata <span class="fu">createMetadataWithCorrelation</span><span class="op">(</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> aggregateType<span class="op">,</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> aggregateId<span class="op">,</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> previousEventId<span class="op">,</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="dt">long</span> currentVersion<span class="op">,</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> userId<span class="op">,</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">final</span> <span class="bu">String</span> correlationId</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> EventMetadata<span class="op">.</span><span class="fu">withCorrelation</span><span class="op">(</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>        aggregateType<span class="op">,</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        aggregateId<span class="op">,</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>        previousEventId<span class="op">,</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>        currentVersion<span class="op">,</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        userId<span class="op">,</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        correlationId</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">);</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="event-store-integration-and-lifecycle-management">Event Store
Integration and Lifecycle Management</h1>
<h2 id="event-store-query-integration">Event Store Query
Integration</h2>
<div class="sourceCode" id="cb8"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/domain/events/AbstractVersionedDomainEvent.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Helper method to get the last event ID for an aggregate from the event store</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> This enables proper causal chain maintenance and event ordering</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="an">aggregateType</span><span class="co"> </span>the type of aggregate</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">aggregateId</span><span class="co"> </span>the unique identifier of the aggregate</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@return</span> the last event ID<span class="co">,</span> or null if no events exist</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="kw">protected</span> <span class="dt">static</span> <span class="bu">String</span> <span class="fu">getLastEventId</span><span class="op">(</span><span class="dt">final</span> <span class="bu">String</span> aggregateType<span class="op">,</span> <span class="dt">final</span> <span class="bu">String</span> aggregateId<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// </span><span class="al">TODO</span><span class="co">: This should query the EventStore to get the last event ID</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// For now, we return null which means this will be treated as the first event</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// This will be implemented when we integrate with the EventStore</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Helper method to get the current version for an aggregate from the event store</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> This enables proper aggregate versioning and optimistic concurrency control</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="an">aggregateType</span><span class="co"> </span>the type of aggregate</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@param</span><span class="co"> </span><span class="an">aggregateId</span><span class="co"> </span>the unique identifier of the aggregate</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@return</span> the current version<span class="co">,</span> or <span class="co">0</span> if no events exist</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="kw">protected</span> <span class="dt">static</span> <span class="dt">long</span> <span class="fu">getCurrentVersion</span><span class="op">(</span><span class="dt">final</span> <span class="bu">String</span> aggregateType<span class="op">,</span> <span class="dt">final</span> <span class="bu">String</span> aggregateId<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">// </span><span class="al">TODO</span><span class="co">: This should query the EventStore to get the current version</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">// For now, we return 0 which means the next event will be version 1</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">// This will be implemented when we integrate with the EventStore</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0L</span><span class="op">;</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="event-version-management">Event Version Management</h2>
<div class="sourceCode" id="cb9"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/domain/events/AbstractVersionedDomainEvent.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Creates a copy of this event with updated version information for versioning scenarios</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> This enables event versioning and migration capabilities in event sourcing systems</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="an">newVersion</span><span class="co"> </span>the new aggregate version for the updated event</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> <span class="an">@return</span> a new event instance with updated version information</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> AbstractVersionedDomainEvent <span class="fu">withVersion</span><span class="op">(</span><span class="dt">final</span> <span class="dt">long</span> newVersion<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// This is abstract because each concrete event class needs to implement</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// its own copy constructor with the new version</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">UnsupportedOperationException</span><span class="op">(</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Subclasses must implement withVersion method for proper version management&quot;</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">);</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="event-description-and-debugging-support">Event Description and
Debugging Support</h2>
<div class="sourceCode" id="cb10"
data-tangle="../bytehot/src/main/java/org/acmsl/bytehot/domain/events/AbstractVersionedDomainEvent.java"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> Gets a human<span class="co">-</span>readable description of this event for debugging and logging</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a> <span class="co">*</span> This provides comprehensive event information for operational visibility</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span><span class="an">@return</span> a detailed description of the event including type and metadata</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="bu">String</span> <span class="fu">getDescription</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">String</span><span class="op">.</span><span class="fu">format</span><span class="op">(</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;</span><span class="sc">%s</span><span class="st">[aggregateType=</span><span class="sc">%s</span><span class="st">, aggregateId=</span><span class="sc">%s</span><span class="st">, version=</span><span class="sc">%d</span><span class="st">, timestamp=</span><span class="sc">%s</span><span class="st">, userId=</span><span class="sc">%s</span><span class="st">]&quot;</span><span class="op">,</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">getEventType</span><span class="op">(),</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        aggregateType<span class="op">,</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>        aggregateId<span class="op">,</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>        aggregateVersion<span class="op">,</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>        timestamp<span class="op">,</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>        userId <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> userId <span class="op">:</span> <span class="st">&quot;system&quot;</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">);</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1
id="integration-with-bytehot-event-sourcing-architecture">Integration
with ByteHot Event Sourcing Architecture</h1>
<h2 id="domain-event-processing-integration">Domain Event Processing
Integration</h2>
<p>The AbstractVersionedDomainEvent integrates with ByteHot's
comprehensive event processing:</p>
<ul>
<li><strong><strong>Event Store Integration</strong></strong>: All
events inherit proper event store integration capabilities</li>
<li><strong><strong>Aggregate Lifecycle</strong></strong>: Provides
complete aggregate lifecycle management through versioning</li>
<li><strong><strong>Causal Chain Management</strong></strong>: Maintains
proper causal relationships between related events</li>
<li><strong><strong>Temporal Analysis</strong></strong>: Enables
sophisticated temporal analysis through comprehensive timestamps</li>
</ul>
<h2 id="hexagonal-architecture-compliance">Hexagonal Architecture
Compliance</h2>
<p>The implementation follows strict hexagonal architecture
principles:</p>
<ul>
<li><strong><strong>Domain Purity</strong></strong>: Pure domain logic
without infrastructure dependencies</li>
<li><strong><strong>Port Integration</strong></strong>: Clean
integration with EventStorePort through standardized interfaces</li>
<li><strong><strong>Dependency Inversion</strong></strong>: Abstractions
depend on domain contracts, not implementations</li>
<li><strong><strong>Testability</strong></strong>: Comprehensive
testability through dependency injection and mocking</li>
</ul>
<h2 id="event-sourcing-pattern-implementation">Event Sourcing Pattern
Implementation</h2>
<p>The design supports comprehensive event sourcing patterns:</p>
<ul>
<li><strong><strong>Immutable Events</strong></strong>: All events are
immutable value objects with complete metadata</li>
<li><strong><strong>Aggregate Versioning</strong></strong>: Proper
aggregate versioning for optimistic concurrency control</li>
<li><strong><strong>Event Correlation</strong></strong>: Support for
sophisticated event correlation and tracing</li>
<li><strong><strong>State Reconstruction</strong></strong>: Complete
support for aggregate state reconstruction from events</li>
</ul>
<h1 id="performance-optimization-and-memory-management">Performance
Optimization and Memory Management</h1>
<h2 id="memory-efficiency-strategies">Memory Efficiency Strategies</h2>
<p>The implementation optimizes memory usage:</p>
<ul>
<li><strong><strong>Immutable Design</strong></strong>: Prevents
unnecessary object mutations and memory leaks</li>
<li><strong><strong>Primitive Fields</strong></strong>: Uses primitive
types where possible to minimize boxing overhead</li>
<li><strong><strong>Efficient String Handling</strong></strong>:
Optimized string handling for identifiers and metadata</li>
<li><strong><strong>Lazy Computation</strong></strong>: Defers expensive
computations until actually needed</li>
</ul>
<h2 id="event-creation-optimization">Event Creation Optimization</h2>
<p>The factory methods provide optimized event creation:</p>
<ul>
<li><strong><strong>Metadata Reuse</strong></strong>: EventMetadata
encapsulation enables efficient metadata reuse</li>
<li><strong><strong>Factory Patterns</strong></strong>: Factory methods
enable optimized object creation patterns</li>
<li><strong><strong>Constructor Overloading</strong></strong>: Multiple
constructors for different creation scenarios</li>
<li><strong><strong>Default Value Handling</strong></strong>:
Intelligent default value handling for optional metadata</li>
</ul>
<h2 id="serialization-and-storage-optimization">Serialization and
Storage Optimization</h2>
<p>The design supports efficient serialization:</p>
<ul>
<li><strong><strong>Clean Separation</strong></strong>: Metadata
separation enables efficient serialization strategies</li>
<li><strong><strong>Version Evolution</strong></strong>: Schema
versioning supports event evolution and migration</li>
<li><strong><strong>Compact Representation</strong></strong>: Efficient
field organization for serialization optimization</li>
<li><strong><strong>Type Safety</strong></strong>: Strong typing
prevents serialization errors and data corruption</li>
</ul>
<h1 id="error-handling-and-validation">Error Handling and
Validation</h1>
<h2 id="metadata-validation">Metadata Validation</h2>
<p>The implementation provides comprehensive metadata validation:</p>
<ul>
<li><strong><strong>Required Field Validation</strong></strong>: Ensures
all essential metadata is properly provided</li>
<li><strong><strong>Version Consistency</strong></strong>: Validates
aggregate version consistency and progression</li>
<li><strong><strong>Identifier Validation</strong></strong>: Ensures
proper event and aggregate identifier formats</li>
<li><strong><strong>Temporal Validation</strong></strong>: Validates
timestamp consistency and chronological ordering</li>
</ul>
<h2 id="event-lifecycle-validation">Event Lifecycle Validation</h2>
<p>The class ensures proper event lifecycle management:</p>
<ul>
<li><strong><strong>Creation Validation</strong></strong>: Validates
proper event creation with complete metadata</li>
<li><strong><strong>Version Progression</strong></strong>: Ensures
proper version progression and concurrency control</li>
<li><strong><strong>Causal Chain Validation</strong></strong>: Validates
proper causal chain maintenance and integrity</li>
<li><strong><strong>User Context Validation</strong></strong>: Ensures
proper user context preservation and validation</li>
</ul>
<h1 id="extension-points-and-customization">Extension Points and
Customization</h1>
<h2 id="subclass-implementation-requirements">Subclass Implementation
Requirements</h2>
<p>The abstract class defines clear requirements for subclasses:</p>
<ul>
<li><strong><strong>withVersion Implementation</strong></strong>:
Subclasses must implement proper version management</li>
<li><strong><strong>Event Type Specification</strong></strong>: Concrete
events must provide specific event type information</li>
<li><strong><strong>Domain Data Integration</strong></strong>:
Subclasses add domain-specific data while preserving metadata</li>
<li><strong><strong>Factory Method Usage</strong></strong>: Subclasses
should use provided factory methods for consistency</li>
</ul>
<h2 id="customization-opportunities">Customization Opportunities</h2>
<p>The design supports various customization scenarios:</p>
<ul>
<li><strong><strong>Custom Metadata</strong></strong>: Additional
metadata can be added through EventMetadata extension</li>
<li><strong><strong>Specialized Factories</strong></strong>: Custom
factory methods for domain-specific event creation</li>
<li><strong><strong>Validation Extensions</strong></strong>: Additional
validation logic for domain-specific requirements</li>
<li><strong><strong>Integration Patterns</strong></strong>: Custom
integration patterns for specific storage or processing needs</li>
</ul>
<h1 id="related-documentation">Related Documentation</h1>
<ul>
<li><span class="spurious-link"
target="EventMetadata.org"><em>EventMetadata</em></span>: Comprehensive
metadata management used by this base class</li>
<li><span class="spurious-link"
target="EventStorePort.org"><em>EventStorePort</em></span>: Storage
interface for versioned domain events</li>
<li><span class="spurious-link"
target="events/ClassFileChanged.org"><em>ClassFileChanged</em></span>:
Example concrete implementation of this base class</li>
<li><span class="spurious-link"
target="events/HotSwapRequested.org"><em>HotSwapRequested</em></span>:
Another example concrete implementation</li>
<li><span class="spurious-link"
target="flows/event-sourcing-persistence-flow.org"><em>Event Sourcing
Persistence Flow</em></span>: Complete event lifecycle
documentation</li>
</ul>
<h1 id="implementation-notes">Implementation Notes</h1>
<h2 id="design-patterns-applied">Design Patterns Applied</h2>
<p>The base class leverages several sophisticated design patterns:</p>
<ul>
<li><strong><strong>Template Method Pattern</strong></strong>: Provides
common structure with customizable implementations</li>
<li><strong><strong>Factory Method Pattern</strong></strong>: Multiple
factory methods for different creation scenarios</li>
<li><strong><strong>Value Object Pattern</strong></strong>: Immutable
design with comprehensive equality and comparison</li>
<li><strong><strong>Strategy Pattern</strong></strong>: Different
metadata creation strategies for various use cases</li>
</ul>
<h2 id="domain-driven-design-principles">Domain-Driven Design
Principles</h2>
<p>The implementation follows strict DDD principles:</p>
<ul>
<li><strong><strong>Rich Domain Events</strong></strong>: Comprehensive
business context with complete metadata</li>
<li><strong><strong>Event-First Design</strong></strong>: Events as
first-class citizens with complete lifecycle support</li>
<li><strong><strong>Aggregate Boundary Respect</strong></strong>: Proper
aggregate identification and versioning</li>
<li><strong><strong>Ubiquitous Language</strong></strong>: Clear,
business-focused naming and comprehensive documentation</li>
</ul>
<h2 id="future-enhancement-opportunities">Future Enhancement
Opportunities</h2>
<p>The design supports future enhancements:</p>
<ul>
<li><strong><strong>Advanced Correlation</strong></strong>: Machine
learning-based event correlation and pattern recognition</li>
<li><strong><strong>Performance Analytics</strong></strong>: Built-in
performance monitoring and optimization capabilities</li>
<li><strong><strong>Distributed Tracing</strong></strong>: Enhanced
distributed tracing and observability integration</li>
<li><strong><strong>Event Evolution</strong></strong>: Advanced event
schema evolution and migration capabilities</li>
</ul>
<p>The AbstractVersionedDomainEvent provides ByteHot's essential event
sourcing foundation while maintaining clean domain boundaries,
comprehensive metadata management, and extensibility for advanced event
processing capabilities throughout the entire intelligent event-driven
system lifecycle.</p>
</main>
<div class="footer">
    ByteHot - Revolutionary JVM Hot-Swapping | 
    <a href="https://github.com/rydnr/bytehot">GitHub</a> | 
    <a href="https://rydnr.github.io/bytehot/docs/">Documentation</a> | 
    <a href="https://rydnr.github.io/bytehot/javadocs/">API Docs</a>
</div>
</body></html>
